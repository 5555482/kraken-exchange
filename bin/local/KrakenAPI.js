// Generated by CoffeeScript 2.0.0-beta2
(function() {
  var API, APIVERSION, KrakenAPI, KrakenResponse, Path, Request, TIMEOUT, URL;

  Request = require('request-promise-native');

  Path = require('path');

  ({URL} = require('url'));

  KrakenResponse = require('./KrakenResponse');

  API = 'https://api.kraken.com';

  APIVERSION = 0;

  TIMEOUT = 20000;

  KrakenAPI = class KrakenAPI {
    constructor(path, headers = {}, form) {
      this.headers = headers;
      this.form = form;
      this.url = new URL(`${APIVERSION}/${path}`, API);
    }

    api() {
      this.headers['User-Agent'] = 'Kraken Exchange Node Client';
      return Request({
        method: 'POST',
        url: this.url,
        headers: this.headers,
        form: this.form,
        timeout: TIMEOUT
      }).then(function(response) {
        return new KrakenResponse(response);
      }).catch(function(err) {
        throw new Error(err);
      });
    }

  };

  module.exports = KrakenAPI;

}).call(this);
